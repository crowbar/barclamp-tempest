#!/usr/bin/ruby

# Generate CSV for importing tempest results into Excel/OpenOffice. 
# The main usecase is to compare two sets of test results to see the delta but 
# it will accept a single filename as input as well if you just want a CSV of saved xml output.
# XML Snippet:
# <?xml version="1.0" encoding="UTF-8"?>
# <testsuite name="nosetests" tests="700" errors="24" failures="43" skip="68">
#  <testcase classname="tempest.tests.object_storage.test_object_services.ObjectTest" name="test_write_public_object_without_using_creds[smoke]" time="0.004">
#   <skipped type="unittest.case.SkipTest" message="EC2 InstanceRunTest: requires ami/aki/ari manifest&#10;-------------------- &gt;&gt; begin captured logging &lt;&lt; --------------------&#10;tempest.config: INFO: Using tempest config file /opt/tempest/etc/tempest.conf&#10;urllib3.connectionpool: INFO: Starting new HTTP connection (1): 192.168.124.83&#10;urllib3.connectionpool: DEBUG: &quot;POST /v2.0/tokens HTTP/1.1&quot; 200 None&#10;urllib3.connectionpool: INFO: Starting new HTTP connection (1): 192.168.124.83&#10;urllib3.connectionpool: DEBUG: &quot;GET /v2.0/users/369bfd03e5614e9cb6ec8ae9ed77a70e/credentials/OS-EC2 HTTP/1.1&quot; 200 None&#10;urllib3.connectionpool: INFO: Starting new HTTP connection (1): 192.168.124.83&#10;urllib3.connectionpool: DEBUG: &quot;POST /v2.0/users/369bfd03e5614e9cb6ec8ae9ed77a70e/credentials/OS-EC2 HTTP/1.1&quot; 200 None&#10;urllib3.connectionpool: INFO: Starting new HTTP connection (1): 192.168.124.83&#10;urllib3.connectionpool: DEBUG: &quot;POST /v2.0/tokens HTTP/1.1&quot; 200 None&#10;urllib3.connectionpool: INFO: Starting new HTTP connection (1): 192.168.124.83&#10;urllib3.connectionpool: DEBUG: &quot;GET /v2.0/users/369bfd03e5614e9cb6ec8ae9ed77a70e/credentials/OS-EC2 HTTP/1.1&quot; 200 None&#10;tempest.tests.compute: DEBUG: Entering tempest.tests.compute.setup_package&#10;tempest.common.rest_client: INFO: Request: GET http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/extensions&#10;tempest.common.rest_client: DEBUG: Request Headers: {'X-Auth-Token': '&lt;Token omitted&gt;'}&#10;tempest.common.rest_client: INFO: Response Status: 200&#10;tempest.common.rest_client: DEBUG: Response Headers: {'content-length': '15304', 'content-location': u'http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/extensions', 'date': 'Thu, 12 Sep 2013 13:26:03 GMT', 'x-compute-request-id': 'req-28882d21-43a0-463a-97c1-d7c571e23a7a', 'content-type': 'application/json'}&#10;tempest.common.rest_client: DEBUG: Response Body: {&quot;extensions&quot;: [{&quot;updated&quot;: &quot;2011-06-09T00:00:00+00:00&quot;, &quot;name&quot;: &quot;Multinic&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/multinic/api/v1.1&quot;, &quot;alias&quot;: &quot;NMN&quot;, &quot;description&quot;: &quot;Multiple network support.&quot;}, {&quot;updated&quot;: &quot;2011-09-27T00:00:00+00:00&quot;, &quot;name&quot;: &quot;DiskConfig&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/disk_config/api/v1.1&quot;, &quot;alias&quot;: &quot;OS-DCF&quot;, &quot;description&quot;: &quot;Disk Management Extension.&quot;}, {&quot;updated&quot;: &quot;2013-01-30T00:00:00+00:00&quot;, &quot;name&quot;: &quot;ExtendedAvailabilityZone&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/extended_availability_zone/api/v2&quot;, &quot;alias&quot;: &quot;OS-EXT-AZ&quot;, &quot;description&quot;: &quot;Extended Server Attributes support.&quot;}, {&quot;updated&quot;: &quot;2013-02-19T00:00:00+00:00&quot;, &quot;name&quot;: &quot;ImageSize&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/image_size/api/v1.1&quot;, &quot;alias&quot;: &quot;OS-EXT-IMG-SIZE&quot;, &quot;description&quot;: &quot;Adds image size to image listings.&quot;}, {&quot;updated&quot;: &quot;2013-01-06T00:00:00+00:00&quot;, &quot;name&quot;: &quot;ExtendedIps&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/extended_ips/api/v1.1&quot;, &quot;alias&quot;: &quot;OS-EXT-IPS&quot;, &quot;description&quot;: &quot;Adds type parameter to the ip list.&quot;}, {&quot;updated&quot;: &quot;2011-11-03T00:00:00+00:00&quot;, &quot;name&quot;: &quot;ExtendedServerAttributes&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/extended_status/api/v1.1&quot;, &quot;alias&quot;: &quot;OS-EXT-SRV-ATTR&quot;, &quot;description&quot;: &quot;Extended Server Attributes support.&quot;}, {&quot;updated&quot;: &quot;2011-11-03T00:00:00+00:00&quot;, &quot;name&quot;: &quot;ExtendedStatus&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/extended_status/api/v1.1&quot;, &quot;alias&quot;: &quot;OS-EXT-STS&quot;, &quot;description&quot;: &quot;Extended Status support.&quot;}, {&quot;updated&quot;: &quot;2012-08-29T00:00:00+00:00&quot;, &quot;name&quot;: &quot;FlavorDisabled&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/flavor_disabled/api/v1.1&quot;, &quot;alias&quot;: &quot;OS-FLV-DISABLED&quot;, &quot;description&quot;: &quot;Support to show the disabled status of a flavor.&quot;}, {&quot;updated&quot;: &quot;2011-09-14T00:00:00+00:00&quot;, &quot;name&quot;: &quot;FlavorExtraData&quot;, &quot;links&quot;: [], &quot;namespace&quot;: &quot;http://docs.openstack.org/compute/ext/flavor_extra_data/api/v1.1&#10;tempest.common.rest_client: DEBUG: Large body (15304) md5 summary: bf1d0fe6a8a9edbabe193f87e6ab5c68&#10;tempest.common.rest_client: INFO: Request: GET http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&#10;tempest.common.rest_client: DEBUG: Request Headers: {'X-Auth-Token': '&lt;Token omitted&gt;'}&#10;tempest.common.rest_client: INFO: Response Status: 200&#10;tempest.common.rest_client: DEBUG: Response Headers: {'content-length': '852', 'content-location': u'http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57', 'date': 'Thu, 12 Sep 2013 13:26:04 GMT', 'x-compute-request-id': 'req-de96a874-2e2a-4c42-9df0-ed239e0e0ae4', 'content-type': 'application/json'}&#10;tempest.common.rest_client: DEBUG: Response Body: {&quot;image&quot;: {&quot;status&quot;: &quot;ACTIVE&quot;, &quot;updated&quot;: &quot;2013-09-12T13:16:26Z&quot;, &quot;links&quot;: [{&quot;href&quot;: &quot;http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;rel&quot;: &quot;self&quot;}, {&quot;href&quot;: &quot;http://192.168.126.3:8774/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;rel&quot;: &quot;bookmark&quot;}, {&quot;href&quot;: &quot;http://192.168.126.3:9292/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;type&quot;: &quot;application/vnd.openstack.image&quot;, &quot;rel&quot;: &quot;alternate&quot;}], &quot;id&quot;: &quot;a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;OS-EXT-IMG-SIZE:size&quot;: 25165824, &quot;name&quot;: &quot;cirros-0.3.0-x86_64-tempest-machine&quot;, &quot;created&quot;: &quot;2013-09-12T13:16:25Z&quot;, &quot;minDisk&quot;: 0, &quot;progress&quot;: 100, &quot;minRam&quot;: 0, &quot;metadata&quot;: {&quot;kernel_id&quot;: &quot;7d572276-b1a7-4568-9adb-b8363c9b41a4&quot;, &quot;ramdisk_id&quot;: &quot;16eda773-ac4e-49e1-9db1-c844068d3c6d&quot;}}}&#10;tempest.common.rest_client: INFO: Request: GET http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&#10;tempest.common.rest_client: DEBUG: Request Headers: {'X-Auth-Token': '&lt;Token omitted&gt;'}&#10;tempest.common.rest_client: INFO: Response Status: 200&#10;tempest.common.rest_client: DEBUG: Response Headers: {'content-length': '852', 'content-location': u'http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57', 'date': 'Thu, 12 Sep 2013 13:26:04 GMT', 'x-compute-request-id': 'req-0fb99377-e222-4687-90f7-3f013814c41b', 'content-type': 'application/json'}&#10;tempest.common.rest_client: DEBUG: Response Body: {&quot;image&quot;: {&quot;status&quot;: &quot;ACTIVE&quot;, &quot;updated&quot;: &quot;2013-09-12T13:16:26Z&quot;, &quot;links&quot;: [{&quot;href&quot;: &quot;http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;rel&quot;: &quot;self&quot;}, {&quot;href&quot;: &quot;http://192.168.126.3:8774/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;rel&quot;: &quot;bookmark&quot;}, {&quot;href&quot;: &quot;http://192.168.126.3:9292/dd5e7aae4806472896cae8fbd6c5aeb2/images/a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;type&quot;: &quot;application/vnd.openstack.image&quot;, &quot;rel&quot;: &quot;alternate&quot;}], &quot;id&quot;: &quot;a9e4c0f9-b5f4-4882-b625-dbc705034d57&quot;, &quot;OS-EXT-IMG-SIZE:size&quot;: 25165824, &quot;name&quot;: &quot;cirros-0.3.0-x86_64-tempest-machine&quot;, &quot;created&quot;: &quot;2013-09-12T13:16:25Z&quot;, &quot;minDisk&quot;: 0, &quot;progress&quot;: 100, &quot;minRam&quot;: 0, &quot;metadata&quot;: {&quot;kernel_id&quot;: &quot;7d572276-b1a7-4568-9adb-b8363c9b41a4&quot;, &quot;ramdisk_id&quot;: &quot;16eda773-ac4e-49e1-9db1-c844068d3c6d&quot;}}}&#10;tempest.common.rest_client: INFO: Request: GET http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/6&#10;tempest.common.rest_client: DEBUG: Request Headers: {'X-Auth-Token': '&lt;Token omitted&gt;'}&#10;tempest.common.rest_client: INFO: Response Status: 200&#10;tempest.common.rest_client: DEBUG: Response Headers: {'content-length': '432', 'content-location': u'http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/6', 'date': 'Thu, 12 Sep 2013 13:26:04 GMT', 'x-compute-request-id': 'req-aa6c7c09-1800-4ed6-8763-cf97489e8553', 'content-type': 'application/json'}&#10;tempest.common.rest_client: DEBUG: Response Body: {&quot;flavor&quot;: {&quot;name&quot;: &quot;tempest-stuff-2&quot;, &quot;links&quot;: [{&quot;href&quot;: &quot;http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/6&quot;, &quot;rel&quot;: &quot;self&quot;}, {&quot;href&quot;: &quot;http://192.168.126.3:8774/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/6&quot;, &quot;rel&quot;: &quot;bookmark&quot;}], &quot;ram&quot;: 132, &quot;OS-FLV-DISABLED:disabled&quot;: false, &quot;vcpus&quot;: 1, &quot;swap&quot;: &quot;&quot;, &quot;os-flavor-access:is_public&quot;: true, &quot;rxtx_factor&quot;: 1.0, &quot;OS-FLV-EXT-DATA:ephemeral&quot;: 0, &quot;disk&quot;: 1, &quot;id&quot;: &quot;6&quot;}}&#10;tempest.common.rest_client: INFO: Request: GET http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/7&#10;tempest.common.rest_client: DEBUG: Request Headers: {'X-Auth-Token': '&lt;Token omitted&gt;'}&#10;tempest.common.rest_client: INFO: Response Status: 200&#10;tempest.common.rest_client: DEBUG: Response Headers: {'content-length': '430', 'content-location': u'http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/7', 'date': 'Thu, 12 Sep 2013 13:26:04 GMT', 'x-compute-request-id': 'req-8e776369-133c-4dbd-ab63-72c10655436c', 'content-type': 'application/json'}&#10;tempest.common.rest_client: DEBUG: Response Body: {&quot;flavor&quot;: {&quot;name&quot;: &quot;tempest-stuff&quot;, &quot;links&quot;: [{&quot;href&quot;: &quot;http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/7&quot;, &quot;rel&quot;: &quot;self&quot;}, {&quot;href&quot;: &quot;http://192.168.126.3:8774/dd5e7aae4806472896cae8fbd6c5aeb2/flavors/7&quot;, &quot;rel&quot;: &quot;bookmark&quot;}], &quot;ram&quot;: 128, &quot;OS-FLV-DISABLED:disabled&quot;: false, &quot;vcpus&quot;: 1, &quot;swap&quot;: &quot;&quot;, &quot;os-flavor-access:is_public&quot;: true, &quot;rxtx_factor&quot;: 1.0, &quot;OS-FLV-EXT-DATA:ephemeral&quot;: 0, &quot;disk&quot;: 1, &quot;id&quot;: &quot;7&quot;}}&#10;--------------------- &gt;&gt; end captured logging &lt;&lt; ---------------------">
#   <error type="testtools.testresult.real._StringException" message="Traceback (most recent call last):&#10;  File &quot;/opt/tempest/tempest/tests/boto/test_ec2_volumes.py&quot;, line 61, in test_create_volume_from_snapshot&#10;    self.assertVolumeStatusWait(volume, &quot;available&quot;)&#10;  File &quot;/opt/tempest/tempest/testboto.py&quot;, line 352, in assertVolumeStatusWait&#10;    state = self.waitVolumeStatus(lfunction, wait_for)&#10;  File &quot;/opt/tempest/tempest/testboto.py&quot;, line 341, in waitVolumeStatus&#10;    self.valid_volume_status)&#10;  File &quot;/opt/tempest/tempest/testboto.py&quot;, line 323, in state_wait_gone&#10;    state = state_wait(lfunction, final_set, valid_set)&#10;  File &quot;/opt/tempest/tempest/tests/boto/utils/wait.py&quot;, line 61, in state_wait&#10;    status = lfunction()&#10;  File &quot;/opt/tempest/tempest/testboto.py&quot;, line 306, in _status&#10;    obj.update(validate=True)&#10;  File &quot;/usr/lib/python2.7/dist-packages/boto/ec2/volume.py&quot;, line 88, in update&#10;    unfiltered_rs = self.connection.get_all_volumes([self.id])&#10;  File &quot;/usr/lib/python2.7/dist-packages/boto/ec2/connection.py&quot;, line 1309, in get_all_volumes&#10;    [('item', Volume)], verb='POST')&#10;  File &quot;/usr/lib/python2.7/dist-packages/boto/connection.py&quot;, line 882, in get_list&#10;    response = self.make_request(action, params, path, verb)&#10;  File &quot;/usr/lib/python2.7/dist-packages/boto/connection.py&quot;, line 868, in make_request&#10;    return self._mexe(http_request)&#10;  File &quot;/usr/lib/python2.7/dist-packages/boto/connection.py&quot;, line 794, in _mexe&#10;    raise e&#10;timeout: timed out&#10;&#10;-------------------- &gt;&gt; begin captured logging &lt;&lt; --------------------&#10;boto: DEBUG: Method: POST&#10;boto: DEBUG: Path: /services/Cloud/&#10;boto: DEBUG: Data: &#10;boto: DEBUG: Headers: {}&#10;boto: DEBUG: Host: localhost:8773&#10;boto: DEBUG: establishing HTTP connection: kwargs={'timeout': 3}&#10;boto: DEBUG: Token: None&#10;boto: DEBUG: using _calc_signature_2&#10;boto: DEBUG: query string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=CreateVolume&amp;AvailabilityZone=nova&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Size=1&amp;Timestamp=2013-09-12T13%3A26%3A19Z&amp;Version=2011-12-15&#10;boto: DEBUG: string_to_sign: POST&#10;localhost:8773&#10;/services/Cloud/&#10;AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=CreateVolume&amp;AvailabilityZone=nova&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Size=1&amp;Timestamp=2013-09-12T13%3A26%3A19Z&amp;Version=2011-12-15&#10;boto: DEBUG: len(b64)=44&#10;boto: DEBUG: base64 encoded digest: kxtVlnfdXPV1rjDSnCzPVQRga/gyDmlVN89G3uFEBSg=&#10;boto: DEBUG: query_string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=CreateVolume&amp;AvailabilityZone=nova&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Size=1&amp;Timestamp=2013-09-12T13%3A26%3A19Z&amp;Version=2011-12-15 Signature: kxtVlnfdXPV1rjDSnCzPVQRga/gyDmlVN89G3uFEBSg=&#10;boto: DEBUG: &lt;?xml version=&quot;1.0&quot; ?&gt;&lt;CreateVolumeResponse xmlns=&quot;http://ec2.amazonaws.com/doc/2011-12-15/&quot;&gt;&lt;requestId&gt;req-23dd0075-a876-4562-8975-d0db28199c15&lt;/requestId&gt;&lt;status&gt;creating&lt;/status&gt;&lt;availabilityZone&gt;nova&lt;/availabilityZone&gt;&lt;volumeId&gt;vol-00000002&lt;/volumeId&gt;&lt;attachmentSet&gt;&lt;item/&gt;&lt;/attachmentSet&gt;&lt;snapshotId/&gt;&lt;createTime&gt;2013-09-12T13:26:19.414448&lt;/createTime&gt;&lt;size&gt;1&lt;/size&gt;&lt;/CreateVolumeResponse&gt;&#10;boto: DEBUG: closing all HTTP connections&#10;boto: DEBUG: Method: POST&#10;boto: DEBUG: Path: /services/Cloud/&#10;boto: DEBUG: Data: &#10;boto: DEBUG: Headers: {}&#10;boto: DEBUG: Host: localhost:8773&#10;boto: DEBUG: Token: None&#10;boto: DEBUG: using _calc_signature_2&#10;boto: DEBUG: query string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A19Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002&#10;boto: DEBUG: string_to_sign: POST&#10;localhost:8773&#10;/services/Cloud/&#10;AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A19Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002&#10;boto: DEBUG: len(b64)=44&#10;boto: DEBUG: base64 encoded digest: vPTaUWy/NDmAgCohtvUIqFvedqIX+TpVHHASB/U+i5c=&#10;boto: DEBUG: query_string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A19Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002 Signature: vPTaUWy/NDmAgCohtvUIqFvedqIX+TpVHHASB/U+i5c=&#10;boto: DEBUG: &lt;?xml version=&quot;1.0&quot; ?&gt;&lt;DescribeVolumesResponse xmlns=&quot;http://ec2.amazonaws.com/doc/2011-12-15/&quot;&gt;&lt;requestId&gt;req-29fad3b5-1b7f-4ad7-b3dc-696c28256e05&lt;/requestId&gt;&lt;volumeSet&gt;&lt;item&gt;&lt;status&gt;creating&lt;/status&gt;&lt;availabilityZone&gt;nova&lt;/availabilityZone&gt;&lt;volumeId&gt;vol-00000002&lt;/volumeId&gt;&lt;attachmentSet&gt;&lt;item/&gt;&lt;/attachmentSet&gt;&lt;snapshotId/&gt;&lt;createTime&gt;2013-09-12T13:26:19.000000&lt;/createTime&gt;&lt;size&gt;1&lt;/size&gt;&lt;/item&gt;&lt;/volumeSet&gt;&lt;/DescribeVolumesResponse&gt;&#10;boto: DEBUG: Method: POST&#10;boto: DEBUG: Path: /services/Cloud/&#10;boto: DEBUG: Data: &#10;boto: DEBUG: Headers: {}&#10;boto: DEBUG: Host: localhost:8773&#10;boto: DEBUG: Token: None&#10;boto: DEBUG: using _calc_signature_2&#10;boto: DEBUG: query string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A21Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002&#10;boto: DEBUG: string_to_sign: POST&#10;localhost:8773&#10;/services/Cloud/&#10;AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A21Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002&#10;boto: DEBUG: len(b64)=44&#10;boto: DEBUG: base64 encoded digest: tAl9W7ufBgt9ieKWlYmMgpwVYDaYf2wBEvtzFEQHe+E=&#10;boto: DEBUG: query_string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A21Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002 Signature: tAl9W7ufBgt9ieKWlYmMgpwVYDaYf2wBEvtzFEQHe+E=&#10;boto: DEBUG: encountered timeout exception, reconnecting&#10;boto: DEBUG: establishing HTTP connection: kwargs={'timeout': 3}&#10;boto: DEBUG: Token: None&#10;boto: DEBUG: using _calc_signature_2&#10;boto: DEBUG: query string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A25Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002&#10;boto: DEBUG: string_to_sign: POST&#10;localhost:8773&#10;/services/Cloud/&#10;AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A25Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002&#10;boto: DEBUG: len(b64)=44&#10;boto: DEBUG: base64 encoded digest: rN6vPenHBKglL5jv/M/bg0d3GdhV+44b0ikXqeHoCyE=&#10;boto: DEBUG: query_string: AWSAccessKeyId=eb3aaf52dd754cbe9d88ad8fd89157a9&amp;Action=DescribeVolumes&amp;SignatureMethod=HmacSHA256&amp;SignatureVersion=2&amp;Timestamp=2013-09-12T13%3A26%3A25Z&amp;Version=2011-12-15&amp;VolumeId.1=vol-00000002 Signature: rN6vPenHBKglL5jv/M/bg0d3GdhV+44b0ikXqeHoCyE=&#10;boto: DEBUG: encountered timeout exception, reconnecting&#10;boto: DEBUG: establishing HTTP connection: kwargs={'timeout': 3}&#10;--------------------- &gt;&gt; end captured logging &lt;&lt; ---------------------">
#   <failure type="testtools.testresult.real._StringException" message="Traceback (most recent call last):&#10;  File &quot;/opt/tempest/tempest/tests/compute/floating_ips/test_floating_ips_actions.py&quot;, line 171, in test_associate_ip_to_server_without_passing_floating_ip&#10;    '', self.server_id)&#10;MismatchError: &lt;bound method FloatingIPsClientJSON.associate_floating_ip_to_server of &lt;tempest.services.compute.json.floating_ips_client.FloatingIPsClientJSON object at 0x37f9490&gt;&gt; returned ({'date': 'Thu, 12 Sep 2013 13:28:01 GMT', 'status': '202', 'content-length': '0', 'content-type': 'text/html; charset=UTF-8'}, '')&#10;&#10;-------------------- &gt;&gt; begin captured logging &lt;&lt; --------------------&#10;tempest.common.rest_client: INFO: Request: POST http://192.168.126.3:8774/v2/dd5e7aae4806472896cae8fbd6c5aeb2/servers/fd082145-0d2b-47be-8469-61fdd5ef7b1d/action&#10;tempest.common.rest_client: DEBUG: Request Headers: {'Content-Type': 'application/json', 'Accept': 'application/json', 'X-Auth-Token': '&lt;Token omitted&gt;'}&#10;tempest.common.rest_client: DEBUG: Request Body: {&quot;addFloatingIp&quot;: {&quot;address&quot;: &quot;&quot;}}&#10;tempest.common.rest_client: INFO: Response Status: 202&#10;tempest.common.rest_client: DEBUG: Response Headers: {'date': 'Thu, 12 Sep 2013 13:28:01 GMT', 'content-length': '0', 'content-type': 'text/html; charset=UTF-8'}&#10;--------------------- &gt;&gt; end captured logging &lt;&lt; ---------------------">
#
require 'rubygems'
require 'xmlsimple'

class TempestResultsProcessor
  
 DOES_NOT_EXIST = 0
 ERROR = 1
 FAILED = 2
 SKIPPED = 3
 
 def  run(args, options={"ForceArray" => false})
    no_compare = true if args.size==1
    currXml = args[0]
    prevXml = args[1] unless no_compare
    currHash = XmlSimple.xml_in(currXml, options)
    prevHash = XmlSimple.xml_in(prevXml, options) unless no_compare
    puts "File Name,Tests,Errors,Failures,Skipped"
    puts "#{currXml},#{currHash['tests']},#{currHash['errors']},#{currHash['failures']},#{currHash['skip']}"
    puts "#{prevXml},#{prevHash['tests']},#{prevHash['errors']},#{prevHash['failures']},#{prevHash['skip']}" unless no_compare
    puts 
    currcases =   currHash["testcase"]
    prevcases =   prevHash["testcase"]  unless no_compare
    classnames =  currcases.uniq { |tc| tc["classname"] }.map { |tcc| tcc["classname"] }
    header = "Test Class,Test Name,#{currXml}"
    header += ",#{prevXml},Delta?" unless no_compare
    puts header
    classnames.each do |cn|
      print "#{cn}"
      currcases.select {|tc| tc["classname"]==cn}.each do |cnn|
        result = ",#{cnn['name']},"
        res1 = nil
        res2 = nil
        if !cnn["skipped"].nil?
          result += "skipped"
          res1 = SKIPPED
        elsif !cnn["error"].nil?
          result += "error"
          res1 = ERROR
        elsif !cnn["failure"].nil?
          result += "failed"
          res1 = FAILED
        else
          result += "#{cnn["time"]}"
        end
        
        unless no_compare
          # find previous result
          prevcase = prevcases.select {|ptc| ptc["classname"]==cn && ptc["name"]==cnn["name"]}.first
          if prevcase.nil?
            result += ",NA"
            res2 = DOES_NOT_EXIST
          elsif !prevcase["skipped"].nil?
            result += ",skipped"
            res2 = SKIPPED
          elsif !prevcase["error"].nil?
            result += ",error"
            res2 = ERROR
          elsif !prevcase["failure"].nil?
            result += ",failed"
            res2 = FAILED
          else
            result += ",#{prevcase["time"]}"
          end 
        end
        if !no_compare && res1 != res2
          result += ",*"
        end
        print "#{result}\n"
      end

    end
  end
end

if __FILE__ == $0
  if ARGV.empty?
    puts "Usage: tempest_results_processor.rb new_results.xml [prev_results.xml]"
    exit
  end
  processor = TempestResultsProcessor.new
  processor.run ARGV

end






